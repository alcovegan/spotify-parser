# Spotify songs parser

Скрипт написан для переноса треков из vk.com в библиотеку Spotify. На самом деле неважно откуда переносить, до тех пор, пока у вас есть список песен в формате _**ARTIST - SONG NAME**_. Но в дальнейшем я пишу о переносе из ВК.

### Установка
```bash
git clone https://github.com/alcovegan/spotify-parser
cd spotify-parser
npm i
```

### Получение списка треков из ВК
В случае, если у вас <5000 треков вк, можно составить плейлист с помощью сайта https://vkpls.boutnew.ru/, там описано, что нужно сделать. Сохраняйте плейлист в формате m3u. В случае когда треков >5000 я сделал довольно просто - зажал клавишу Page Down на странице аудиозаписей, когда дошло до конца - просто скопировал всё и почистил регулярками до вида _**ARTIST - SONG NAME**_. Примеры плейлистов обоих форматов смотрите в репозитории.

### Получение токена Spotify

На этой странице - https://developer.spotify.com/console/get-search-item/ внизу есть поле OAuth Token, возле него кнопка Get Token, нужно нажать её и нажать Request Token, отмечать никакие scope не обязательно. Всё, токен есть, работает он час.

### Запуск скрипта
После того как у вас есть либо плейлист m3u, либо текстовый файл с названиями, нужно кинуть в корень папки скрипта с названием playlist.m3u/txt соответственно.

Дальше простой запуск:

```bash
node index.js TXT [SPOTIFY_TOKEN]
```

В зависимости от типа плейлиста в команде поддерживается либо TXT либо M3U.

После завершения парсинга в консоли будет сообщение примерно такого вида:
```bash
√ Results callback:
Finded 34 tracks
Not finded 11 tracks
File with results written in output/results.json!
./output/added.csv is written successfully!
./output/notadded.csv is written successfully!
```

### Результаты
Лежат в папке output, основной интерес представляют два файла: _**added.csv**_ и _**notadded.csv**_. Соответственно в них лежат файлы, которые нашлись в Спотифай и нет. 

Пример строки из файла найденных треков:

```csv
1	IDLES - Mr. Motivator	IDLES - Mr. Motivator	spotify:track:4AxR2KkfgunnCzueEhRJPD			

```
1 поле - порядок трека в записях (добавляется при парсинге плейлиста для сохранения порядка добавления треков)
2 поле - название трека, по которому производился поиск
3 поле - название трека, найденное в Spotify. Поскольку парсится только первый найденный результат - иногда есть место для ошибки и можно понять, тот ли трек нашёлся.
4 поле - URI трека в Spotify. Скопировав и вставив это в плейлисте в приложении для Windows / Mac - в плейлист вставится нужный трек.

### Добавление в плейлист Spotify
Для начала нужно создать плейлист и открыть его в десктопном приложении на Win/Mac. Разбив по столбцам файл с найденными треками - скопировать столбец Spotify URI (кроме первой строки, конечно же) и зайдя в плейлист нажать CTRL + V / CMD + V соответственно для Win/Mac. Всё, плейлист готов.